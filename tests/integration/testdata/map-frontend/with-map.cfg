global
    log stdout format raw local0
    stats socket /var/run/haproxy.sock mode 600 level admin

defaults
    log     global
    mode    http
    option  httplog
    timeout connect 5000ms
    timeout client  50000ms
    timeout server  50000ms

frontend http
    bind *:80
    use_backend %[req.hdr(host),lower,map(/etc/haproxy/maps/domains.map,web)]

backend web
    balance roundrobin
    server srv1 192.168.1.10:8080 check

backend api
    balance roundrobin
    server srv1 192.168.1.11:8080 check

backend admin
    balance roundrobin
    server srv1 192.168.1.12:8080 check
