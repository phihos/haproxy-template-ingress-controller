# Development values for haproxy-template-ic Helm chart

# Use local development image
image:
  repository: haproxy-template-ic
  tag: dev
  pullPolicy: Never  # Never pull, always use local image

# Enable Gateway API support for development
controller:
  templateLibraries:
    gateway:
      enabled: true

  config:
    logging:
      verbose: 2  # DEBUG level

    templatingSettings:
      extraContext:
        debug: true  # Enable introspection headers for development

# Resource limits for development (allow more flexibility)
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# Disable autoscaling for development (fixed replica count)
autoscaling:
  enabled: false

# Keep network policy but allow permissive access for dev
networkPolicy:
  enabled: true
  egress:
    allowDNS: true
    kubernetesApi:
      - cidr: 0.0.0.0/0  # Permissive for development
        ports:
          - port: 443
            protocol: TCP
          - port: 6443
            protocol: TCP
    haproxyPods:
      enabled: true
      podSelector:
        matchLabels:
          app: haproxy
          component: loadbalancer
      namespaceSelector: {}
      ports:
        - port: 5555
          protocol: TCP
        - port: 8404
          protocol: TCP
  ingress:
    healthChecks:
      enabled: true
      from:
        - podSelector: {}
      ports:
        - port: 8080
          protocol: TCP
    monitoring:
      enabled: false

# Development-specific pod labels for easier identification
podLabels:
  environment: development
  managed-by: dev-script

# Disable health probes until /healthz endpoint is implemented
livenessProbe: {}
readinessProbe: {}

# Disable monitoring for simpler development setup
monitoring:
  serviceMonitor:
    enabled: false

# Enable webhook for development testing
webhook:
  enabled: true
  # secretName defaults to: {{ include "haproxy-template-ic.fullname" . }}-webhook-cert
  certManager:
    enabled: false  # Use manual certificates generated by dev script
  # CA bundle will be set dynamically by dev script via --set webhook.caBundle=...
